#include<stdio.h>
#include<stdlib.h>
#include<conio.h>
/*
Kristjan All
01.04.2012
versiooon: 1.2
*/
main()
{
    char ch, failinimi[20], funktsioon, text[21] ="", liida1[20], liida2[20], liida3[20]; //muutujate deklareerimine
    int j='y', kustuta;
    FILE *fail, *fail1, *fail2;
    while(j)
    {
        printf("Mida tahad teha?[number]\n");
        printf("*   1. kirjutada        *\n");
        printf("*   2. kustutada        *\n");
        printf("*   3. liida 2 faili    *\n");
        printf("*   4. lugeda           *\n"); //võimaluste kirjeldamine
        funktsioon = getchar();
        getchar();
        printf("\n");
        switch(funktsioon){ //moodulid
            case '1':; //Faili kirjutamise moodul

                printf("Sisesta faili nimi \n");
                gets(failinimi);

                fail = fopen(failinimi,"a+"); //avab faili
                printf("Mida tadad faili lisada?\n");
                scanf("%20s",text); //text mida lisatakse faili //kui faili polnud olemas siis luuakse uus fail ja kirjutatakse sinna.
                fprintf(fail,"\n%s",text); // kirjutab faili
                fclose(fail); // sulgeb faili
                return 0;

            break;

            case '2':; //Faili kustutamise moodul

                printf("Sisesta faili nimi\n");
                gets(failinimi);

                kustuta = remove(failinimi);//Faili kustutamine

                if( kustuta == 0 ) //Kustutamise kontroll
                printf("Fail %s on kustitatud edukalt.\n",failinimi);
                else
                {
                    perror("Faili kustutamisel esines tõrge"); //veateade
                }
                return 0;

            break;

            case '3':;

                printf("Sisesta esimese faili nimi ");
                gets(liida1);

                printf("Sisesta teise faili nimi ");
                gets(liida2);

                printf("Sisesta loodava faili nimi ");
                gets(liida3);

                fail1 = fopen(liida1,"r");
                fail2 = fopen(liida2,"r");

                if( fail1 == NULL || fail2 == NULL ) //failide kontroll
                {
                    perror("Esines viga failide avamisel ");
                    exit(EXIT_FAILURE);
                }

                fail = fopen(liida3,"w"); //avab kolmanda faili //kui pole olemas siis loob uue

                while( ( ch = fgetc(fail1) ) != EOF ) //loeb ja kirjutab esimese faili sisu kolmandasse
                    fputc(ch,fail);

                while( ( ch = fgetc(fail2) ) != EOF ) //loeb ja kirjutab teise faili sisu kolmandasse
                    fputc(ch,fail);

                printf("Kaks faili on edukalt liidetud.\n");

                fclose(fail1); //sulgeb failid
                fclose(fail2);
                fclose(fail);

                getch();
                return 0;

            break;

            case '4':;

                printf("Sisesta faili nimi ");
                gets(failinimi);

                fail = fopen(failinimi,"r");

                if( fail == NULL )
                {
                    perror("Faili avamisel ilmnes viga.\n");
                    exit(EXIT_FAILURE);
                }

                printf("Faili %s sisu on :  \n\n", failinimi);

                while( ( ch = fgetc(fail) ) != EOF )
                printf("%c",ch);
                printf(" \n");

                fclose(fail);
                return 0;

            break;
        }
    }
    return 0;
}
